<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <title>Sistema de suport a la planificació</title>

    <link rel="stylesheet" href="https://js.arcgis.com/4.13/esri/themes/light/main.css" />
	<link rel="stylesheet" href="css/templatemo-style.css">
	<link rel="stylesheet" href="css/style_let.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.css">
	<script type="text/plain" id="arcadeB">
		var fieldsA1 = [
		  { value: $feature.a1a_c_0, alias: "a1a_c_0" },
		  { value: $feature.a1a_c_1, alias: "a1a_c_1" },
		  { value: $feature.a1a_c_2, alias: "a1a_c_2" },
		  { value: $feature.a1a_c_3, alias: "a1a_c_3" },
		  { value: $feature.a1a_o_0, alias: "a1a_o_0" },
		  { value: $feature.a1a_o_1, alias: "a1a_o_1" },
		  { value: $feature.a1a_o_2, alias: "a1a_o_2" },
		  { value: $feature.a1a_o_3, alias: "a1a_o_3" }
		];
		var fieldsA2 = [
		  { value: $feature.a1b_c_0, alias: "a1b_c_0" },
		  { value: $feature.a1b_c_1, alias: "a1b_c_1" },
		  { value: $feature.a1b_c_2, alias: "a1b_c_2" },
		  { value: $feature.a1b_c_3, alias: "a1b_c_3" },
		  { value: $feature.a1b_o_0, alias: "a1b_o_0" },
		  { value: $feature.a1b_o_1, alias: "a1b_o_1" },
		  { value: $feature.a1b_o_2, alias: "a1b_o_2" },
		  { value: $feature.a1b_o_3, alias: "a1b_o_3" }
		];
		var fieldsA3 = [
		  { value: $feature.a1c_c_0, alias: "a1c_c_0" },
		  { value: $feature.a1c_c_1, alias: "a1c_c_1" },
		  { value: $feature.a1c_c_2, alias: "a1c_c_2" },
		  { value: $feature.a1c_c_3, alias: "a1c_c_3" },
		  { value: $feature.a1c_c_0, alias: "a1c_c_0" },
		  { value: $feature.a1c_c_1, alias: "a1c_c_1" },
		  { value: $feature.a1c_c_2, alias: "a1c_c_2" },
		  { value: $feature.a1c_c_3, alias: "a1c_c_3" }
		];
		var fieldsB = [
		  { value: $feature.b1_c_0, alias: "b1_c_0" },
		  { value: $feature.b1_c_1, alias: "b1_c_1" },
		  { value: $feature.b1_c_2, alias: "b1_c_2" },
		  { value: $feature.b1_c_3, alias: "b1_c_3" },
		  { value: $feature.b1_o_0, alias: "b1_o_0" },
		  { value: $feature.b1_o_1, alias: "b1_o_1" },
		  { value: $feature.b1_o_2, alias: "b1_o_2" },
		  { value: $feature.b1_o_3, alias: "b1_o_3" }
		];
		
		var fieldsC = [
		  { value: $feature.c1_c_0, alias: "c1_c_0" },
		  { value: $feature.c1_c_1, alias: "c1_c_1" },
		  { value: $feature.c1_c_2, alias: "c1_c_2" },
		  { value: $feature.c1_c_3, alias: "c1_c_3" },
		  { value: $feature.c1_o_0, alias: "c1_o_0" },
		  { value: $feature.c1_o_1, alias: "c1_o_1" },
		  { value: $feature.c1_o_2, alias: "c1_o_2" },
		  { value: $feature.c1_o_3, alias: "c1_o_3" }
		];
		var fieldsD = [
		  { value: $feature.d1_c_0, alias: "d1_c_0" },
		  { value: $feature.d1_c_1, alias: "d1_c_1" },
		  { value: $feature.d1_c_2, alias: "d1_c_2" },
		  { value: $feature.d1_c_3, alias: "d1_c_3" },
		  { value: $feature.d1_o_0, alias: "d1_o_0" },
		  { value: $feature.d1_o_1, alias: "d1_o_1" },
		  { value: $feature.d1_o_2, alias: "d1_o_2" },
		  { value: $feature.d1_o_3, alias: "d1_o_3" }
		];
		var fieldsE1A = [
		  { value: $feature.e1a_c_0, alias: "e1a_c_0" },
		  { value: $feature.e1a_c_1, alias: "e1a_c_1" },
		  { value: $feature.e1a_c_2, alias: "e1a_c_2" },
		  { value: $feature.e1a_c_3, alias: "e1a_c_3" },
		  { value: $feature.e1a_o_0, alias: "e1a_o_0" },
		  { value: $feature.e1a_o_1, alias: "e1a_o_1" },
		  { value: $feature.e1a_o_2, alias: "e1a_o_2" },
		  { value: $feature.e1a_o_3, alias: "e1a_o_3" }
		];
		var fieldsE1B = [
		  { value: $feature.e1b_c_0, alias: "e1b_c_0" },
		  { value: $feature.e1b_c_1, alias: "e1b_c_1" },
		  { value: $feature.e1b_c_2, alias: "e1b_c_2" },
		  { value: $feature.e1b_c_3, alias: "e1b_c_3" },
		  { value: $feature.e1b_o_0, alias: "e1b_o_0" },
		  { value: $feature.e1b_o_1, alias: "e1b_o_1" },
		  { value: $feature.e1b_o_2, alias: "e1b_o_2" },
		  { value: $feature.e1b_o_3, alias: "e1b_o_3" }
		];
		var fieldsE1C = [
		  { value: $feature.e1c_c_0, alias: "e1c_c_0" },
		  { value: $feature.e1c_c_1, alias: "e1c_c_1" },
		  { value: $feature.e1c_c_2, alias: "e1c_c_2" },
		  { value: $feature.e1c_c_3, alias: "e1c_c_3" },
		  { value: $feature.e1c_o_0, alias: "e1c_o_0" },
		  { value: $feature.e1c_o_1, alias: "e1c_o_1" },
		  { value: $feature.e1c_o_2, alias: "e1c_o_2" },
		  { value: $feature.e1c_o_3, alias: "e1c_o_3" }
		];

		var fieldsF = [
		  { value: $feature.f1_c_0, alias: "f1_c_0" },
		  { value: $feature.f1_c_1, alias: "f1_c_1" },
		  { value: $feature.f1_c_2, alias: "f1_c_2" },
		  { value: $feature.f1_c_3, alias: "f1_c_3" },
		  { value: $feature.f1_o_0, alias: "f1_o_0" },
		  { value: $feature.f1_o_1, alias: "f1_o_1" },
		  { value: $feature.f1_o_2, alias: "f1_o_2" },
		  { value: $feature.f1_o_3, alias: "f1_o_3" }
		];

		function getPredominantCategory(fieldsArray,fieldsArray2){
		  var maxValue = -Infinity;
		  var maxValue2 = 0;
		  var maxCategory = "";
		  for(var k in fieldsArray){
			if(fieldsArray[k].value > maxValue){
			
			  maxValue = fieldsArray[k].value;
			  maxValue2= fieldsArray2[k].value;
			} 
		  }
		  return IIF(maxValue2 <= 0, null, maxValue2);
		}

		function getMaxValue(fieldsArray) 
		{
			var max = -Infinity;
			for (var i in fieldsArray) {
				if (max < fieldsArray[i].value) {
					max = fieldsArray[i].value;
				}
			}
			if (max < 0) return null;
			return max;
		}
		
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://js.arcgis.com/4.13/"></script>

    <style>
      html,
      body,
      #viewDiv,#viewDivtend,#viewDivdif{
        padding: 0;
        margin: 0;
        height: 99%;
        width: 99%;
		color:black;
		font-family: "Avenir Next W00","Helvetica Neue",Helvetica,Arial,sans-serif;
      }
	  #infoDiv,#escenariDiv,#escenariDif{
        padding: 8px;
      }
	  #divTop{
		padding: 12px;
		font-size: 12px;
		color: #323232;
	  }
	  #divActual,#divTendencial, #divDiferencia,#divgrafics {
        padding: 0;
        margin: 0;
        height: 41%;
        width: 50%;
		float:left;
		border-color: coral;
      }
	  #descripcio {
		width:100%;
		border: none;
		font-size: 12px;
		font-family:"Arial";
		margin:5px 0;
	  }
	.pane {
		position: fixed;
		top: 0; left: 0; bottom: 0; right: 0;
		margin: auto;
		width: 820px;
		height: 450px;
		z-index: 1 !important;
		background: #f0f0fd;
		background: rgba(240,240,253,0.90);
		padding: 22px 32px;
		-moz-border-radius: 8px;
		-webkit-border-radius: 8px;
		border-radius: 8px;
		-moz-box-shadow: 0 0 18px rgba(0, 0, 0, 0.9);
		-webkit-box-shadow: 0 0 18px rgba(0, 0, 0, 0.9);
		-box-shadow: 0 0 18px rgba(0, 0, 0, 0.9);
	}
	
	
	.button {
		box-shadow:inset 0px 1px 3px 0px #91b8b3;
		background:linear-gradient(to bottom, #c00000 5%, #c43b3b 100%);
		background-color:#c00000;
		border-radius:5px;
		display:inline-block;
		cursor:pointer;
		color: white !important;
		text-align: center;
		font-family: "Avenir Next W00","Helvetica Neue",Helvetica,Arial,sans-serif;
		font-size:12px;
		margin: 7px 2px;
		padding: 7px 5px ;
		text-decoration:none;
		text-shadow:0px -1px 0px #2b665e;
		width: 90%;
		border:0;
			}
	.button:hover {
		background:linear-gradient(to bottom, #c43b3b 5%, #c00000 100%);
		background-color:#c43b3b;
	}
	.button:active {
		position:relative;
		top:1px;
	}

	.label {
            width:40%;
            display:inline;
            float:left;
        }

		.formRange input {
		width:50%
	}

	.resultRange {
		padding-left:15px;
		text-align:center;
	}

	.formRange {
		padding:5px;
	}

	.formRangeTotal {
		text-align: center;
		font-weight: bold;
	}
	
    </style>

<script src="js/indicadors.js"></script>
<script src="js/indica.js"></script>

  </head>

  <body style="font-family: 'Avenir Next W00','Helvetica Neue',Helvetica,Arial,sans-serif;">
    <nav class="navbar navbar-default templatemo-nav" role="navigation">
		<div class="container">
			<div class="navbar-header">
			<a class="navbar-brand" style="padding:12px 0px 0px 0px !important;" href="https://iermb.uab.cat/ca/let-bcn/" target="_blank">
				<img src="imatges/logo-iermb_sm-creaf.png" alt="Logo" style="width:175px;">
			</a>
		
			
			<a class="navbar-brand" style="padding:0px 0px 0px 30px !important;" href="http://www.amb.cat/" target="_blank">
				<img src="imatges/AMB_logo_1_sm.png" alt="Logo" style="width:60px;float:right;padding:0px 0px 0px 30px !important;">
			</a>
			<a class="navbar-brand" style="padding:50px 0px 0px 50px !important;" href="http://www.creaf.cat/ca" target="_blank" >
				<img src="imatges/logo-creaf_sm.png" alt="Logo" style="width:60px;float:right;padding:0px 0px 0px 30px !important;">
			</a>
			<a class="navbar-brand" style="padding:12px 0px 0px 50px !important;" href="https://iermb.uab.cat/ca/" target="_blank" style="vertical-align:bottom;">
				<img src="imatges/Logo-IERMB-sense-nom_sm.jpg" alt="Logo" style="width:60px;float:right;padding:0px 0px 0px 30px !important;">
			</a>
			<a class="navbar-brand" style="padding:12px 0px 0px 50px !important;" href="https://www.uab.cat/" target="_blank">
				<img src="imatges/uab_2_sm.jpg" alt="Logo" style="width:60px;float:right;padding:0px 0px 0px 30px !important;">
			</a>
			<a class="navbar-brand"  href="https://www.uab.cat/open-labs/" target="_blank">
				<img src="imatges/logoUABopenLABStrans.png" alt="Logo" style="width:90px;float:right;padding:0px 0px 0px 20px !important;">
			</a>
			<!--idiomes-->
			<a style="font-size:12px; font-weight:bold; padding:12px 0px 0px 400px !important;  cursor: pointer" hreflang="ca" href="indicadors.html">Català | </a>
			<a  style="font-size:12px;padding:12px 0px 0px 5px !important;  cursor: pointer" hreflang="es" href="indicadors_es.html">Castellano | </a>
			<a  style="font-size:12px;padding:12px 0px 0px 5px !important;  cursor: pointer" hreflang="en" href="indicadors_en.html">English</a>
		
			</div>
		
		</div>
	</nav>

   <div id="divTop" style="text-align: center;">
	<button class="button" style="width:auto;" onclick="document.getElementById('pane').style.visibility='visible'">Canvi de criteris</button>
   </div>
  <div id="divActual">
    <div id="viewDiv"></div>
	 	<div id="infoDiv" class="esri-widget">
      	Escenari <select class="esri-widget" id="escenari_id" onchange="canvi(valuesRanges())" > 
			<option value="0" selected >Actual</option>
			<option value="1" >Tendencial</option>
		</select>
	  </div>
	</div>
	<div id="divTendencial">
		<div id="viewDivtend"></div>
		<div id="escenariDiv" class="esri-widget">
			Escenari Optimitzat<br>
			  <select id="field-select-ind" class="esri-widget" onchange="canvi(valuesRanges())">
				<option value="A1" selected>Eficiència energètica</option>
				<option value="A2">Consum d’aigua</option>
				<option value="A3">Apropiació de biomassa</option>
				<option value="B">Conservació de la biodiversitat</option>
				<option value="C">Funcionament del paisatge</option>
				<option value="D">Canvi climàtic</option>
				<option value="E1A">Recirculació de nutrients</option>
				<option value="E1B">Estoc de carboni</option>
				<option value="E1C">Producció agrícola</option>
				<option value="F">Llocs de treball</option>
			  </select>
		</div>
	</div>
	<div id="divDiferencia">
		<div id="viewDivdif"></div>
		<div id="escenariDif" class="esri-widget">
			Diferència
		</div>
	</div>
	<div id="divgrafics">
		<div id="marksChart"></div>
	<div>
		<div id="pane" class="pane">
			<div style="font-size:20px;font-family: 'Avenir Next W00','Helvetica Neue',Helvetica,Arial,sans-serif;text-align: center;">
			<b style="color:#c00000">Sistema de suport a la planificació<hr style=" border-top: 1px solid #c00000"></b></div>
			<div class="formRange"><div class="label"><label for="ARange">Eficiència energètica</label></div><input type="range" name="A1Range" id="A1Range" min="0" max="100" step="1" onchange="showVal('A1RangeValue', this.value)" oninput="showVal('A1RangeValue', this.value)"><span class="resultRange" id="A1RangeValue"></span></div>
			<div class="formRange"><div class="label"><label for="ARange">Consum d’aigua</label></div><input type="range" name="A2Range" id="A2Range" min="0" max="100" step="1" onchange="showVal('A2RangeValue', this.value)" oninput="showVal('A2RangeValue', this.value)"><span class="resultRange" id="A2RangeValue"></span></div>
			<div class="formRange"><div class="label"><label for="ARange">Apropiació de biomassa</label></div><input type="range" name="A3Range" id="A3Range" min="0" max="100" step="1" onchange="showVal('A3RangeValue', this.value)" oninput="showVal('A3RangeValue', this.value)"><span class="resultRange" id="A3RangeValue"></span></div>
        	<div class="formRange"><div class="label"><label for="BRange">Conservació de la biodiversitat</label></div><input type="range" name="BRange" id="BRange" min="0" max="100" step="1" onchange="showVal('BRangeValue', this.value)" oninput="showVal('BRangeValue',this.value)"><span class="resultRange" id="BRangeValue"></span></div>
        	<div class="formRange"><div class="label"><label for="CRange">Funcionament del paisatge</label></div><input type="range" name="CRange" id="CRange" min="0" max="100" step="1" onchange="showVal('CRangeValue', this.value)" oninput="showVal('CRangeValue', this.value)"><span class="resultRange" id="CRangeValue"></span></div>
        	<div class="formRange"><div class="label"><label for="DRange">Canvi climàtic</label></div><input type="range" name="DRange" id="DRange" min="0" max="100" step="1" onchange="showVal('DRangeValue', this.value)" oninput="showVal('DRangeValue', this.value)"><span class="resultRange" id="DRangeValue"></span></div>
        	<div class="formRange"><div class="label"><label for="E1ARange">Recirculació de nutrients</label></div><input type="range" name="E1ARange" id="E1ARange" min="0" max="100" step="1" onchange="showVal('E1ARangeValue', this.value)" oninput="showVal('E1ARangeValue', this.value)"><span class="resultRange" id="E1ARangeValue"></span></div>
        	<div class="formRange"><div class="label"><label for="E1BRange">Estoc de carboni</label></div><input type="range" name="E1BRange" id="E1BRange" min="0" max="100" step="1" onchange="showVal('E1BRangeValue', this.value)" oninput="showVal('E1BRangeValue', this.value)"><span class="resultRange" id="E1BRangeValue"></span></div>
        	<div class="formRange"><div class="label"><label for="E1CRange">Producció agrícola</label></div><input type="range" name="E1CRange" id="E1CRange" min="0" max="100" step="1" onchange="showVal('E1CRangeValue', this.value)" oninput="showVal('E1CRangeValue', this.value)"><span class="resultRange" id="E1CRangeValue"></span></div>
        	<div class="formRange"><div class="label"><label for="FRange">Llocs de treball</label></div><input type="range" name="FRange" id="FRange" min="0" max="100" step="1" onchange="showVal('FRangeValue', this.value)" oninput="showVal('FRangeValue', this.value)"><span class="resultRange" id="FRangeValue"></span></div>
			<div class="formRange formRangeTotal">Total: <span id="TotalRanges"></span></div>  
			<text style="font-size:12px;color:#c00000">versió Beta</text>
		  	<button class="button" style="float: right;width:15%;" onclick="if(checkRanges()) { document.getElementById('pane').style.visibility='hidden'; canvi(valuesRanges())} else { alert('Error'); }">Aplicar</button>
		</div>
	
  </body>
  <script>
	function showVal(tag, newVal)
    {
          document.getElementById(tag).innerHTML=newVal;
          updateTotalRanges();
    }

    function iniValues(ranges) 
    {
        ranges.forEach(iniVal);
        updateTotalRanges();
    }

    function iniVal(range) 
    {
        document.getElementById(range + "Value").innerHTML = 10;
        document.getElementById(range).value = 10;
    }

    function updateTotalRanges() 
    {
        var total = 0;
        for (x in ranges) {
            total += parseInt(document.getElementById(ranges[x]).value);
        }
        document.getElementById("TotalRanges").innerHTML = total;
    }

    function checkRanges()
    {
        var total = 0;
        for (x in ranges) {
            total += parseInt(document.getElementById(ranges[x]).value);
        }
		return total == sumTotalRanges;
	}
	
	function valuesRanges()
	{
		valuesRangesList = [];
		for (x in ranges) {
			valuesRangesList.push(parseFloat(document.getElementById(ranges[x]).value)/100);
		}
		return valuesRangesList;
	}

	var iniElemet = 10;
    var sumTotalRanges = 100;

    var ranges = ["A1Range", "A2Range", "A3Range", "BRange", "CRange", "DRange", "E1ARange", "E1BRange", "E1CRange", "FRange"];

    iniValues(ranges);
  </script>
</html>
